这个文件主要讨论了AVS（主动验证服务）运营商面临的安全风险、缓解措施和最佳实践。以下是文件内容的分析和翻译：

分析：
1. 文件首先列举了运营商面临的主要安全风险，包括恶意AVS和AVS实现及部署中的漏洞。
2. 然后提供了一系列缓解这些风险的最佳实践，包括运营商最佳实践和基础设施方面的建议。
3. 最后强调了制定事件响应计划、定期备份和保持更新的重要性。

翻译：

---
sidebar_position: 6
title: 运营商安全风险、缓解措施和最佳实践
---

# 运营商安全风险

## 恶意AVS

- 客户容器入侵主机：
  - 内核漏洞：容器与主机共享相同的内核。如果内核存在漏洞，容器可能会利用它们获得主机上的提升权限。
  - 逃逸到主机：过去曾出现过允许容器内进程逃逸并获取主机访问权限的漏洞。如果容器以提升的权限运行，这尤其危险。
  - 容器间攻击：如果一个容器被攻破，攻击者可能试图横向移动到同一主机上的其他容器。

- 访问主机网络。由于容器在家庭质押者环境中运行，它们可以访问家庭网络或k8s环境。
- 容器中的恶意软件，或通过供应链攻击，或AVS本身是恶意的。

## AVS实现和部署漏洞

- 运行过时的软件。
- 配置错误的端口和服务对互联网开放。
- 以提升的权限运行容器。

# 运营商如何缓解恶意AVS风险？
## 运营商最佳实践

- 定期更新和修补容器和主机系统。
- 不要在AVS / ETH验证者之间共享密钥。参考密钥管理部分。
- 监控容器运行时（日志）行为，查找任何可疑活动，并设置相关警报。
- 不要以特权标志运行容器。这可能给它们几乎不受限制的主机访问权限。
- 限制容器的资源，以防止它耗尽集群/节点资源。
- 数据盗窃：不要将整个卷挂载到容器中，以防止数据泄露、容器逃逸等。
- 在您的组织中遵循网络访问/最小权限原则，以减少攻击面。

## 基础设施

一般建议
- 只允许AVS所需的端口/白名单IP的网络流量。
- 不要将关键服务（如ssh）暴露给互联网。
- 使用"全部拒绝"方法配置防火墙，并明确允许所需的流量。

Docker基础设施
- 网络分段：使用Docker的网络策略对容器进行分段，并限制容器间通信。
- 定期审计：使用Docker Bench for Security或Clair等工具审计和监控容器活动。
- 隔离
  - 通过VM：轻量级VM（如Kata Containers或gVisor）结合了容器的灵活性和VM的隔离性。
  - 用户命名空间、seccomp、AppArmor和SELinux等可以进一步限制容器。

K8's基础设施
- 网络分段：限制您的AVS可以与之通信的服务。通过[Kubernetes文档网络策略](https://kubernetes.io/docs/concepts/services-networking/network-policies/)遵循最小权限原则。

事件响应计划：
- 制定计划，以应对容器被攻破的情况。这包括隔离受影响的容器、分析和恢复服务。
- 定期备份：定期备份您的数据和配置，以从任何恶意更改中恢复。
- 保持更新：始终关注Docker的官方文档、安全公告和社区论坛，了解最新的最佳实践和更新。